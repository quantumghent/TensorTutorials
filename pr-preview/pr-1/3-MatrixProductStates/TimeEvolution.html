



<!DOCTYPE html>


<html lang="en" data-theme="light 
">

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Time Evolution &#8212; TensorTutorials</title>
    
    <script src="https://unpkg.com/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://unpkg.com/tippy.js@6.3.1/dist/tippy-bundle.umd.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
    
        <script>
            MathJax = {
            loader: {load: ['[tex]/boldsymbol', '[tex]/textmacros']},
            tex: {
                packages: {'[+]': ['boldsymbol', 'textmacros']},
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                processEscapes: true,
                macros: {
                    "argmax" : "arg\\,max",
                    "argmin" : "arg\\,min",
                    "col"    : "col",
                    "Span"   :  "span",
                    "epsilon": "\\varepsilon",
                    "EE": "\\mathbb{E}",
                    "PP": "\\mathbb{P}",
                    "RR": "\\mathbb{R}",
                    "NN": "\\mathbb{N}",
                    "ZZ": "\\mathbb{Z}",
                    "aA": "\\mathcal{A}",
                    "bB": "\\mathcal{B}",
                    "cC": "\\mathcal{C}",
                    "dD": "\\mathcal{D}",
                    "eE": "\\mathcal{E}",
                    "fF": "\\mathcal{F}",
                    "gG": "\\mathcal{G}",
                    "hH": "\\mathcal{H}",
                }
            },
            svg: {
                fontCache: 'global',
                scale: 0.92,
                displayAlign: "center",
            },
            };
        </script>
    
    
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "light 
";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=927b94d3fcb96560df09" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=927b94d3fcb96560df09" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=927b94d3fcb96560df09" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=927b94d3fcb96560df09" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/quantumghent-book-theme.5e19e0a6c2e2247c14aaae6dbdd37c4f.css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=927b94d3fcb96560df09" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=927b94d3fcb96560df09" />
  <script src="../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=927b94d3fcb96560df09"></script>


    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script src="../_static/quantumghent-book-theme.ef2ef6c3e8da75e1e736fb5fce08cde6.js"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-3PCWRLGWND"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-3PCWRLGWND');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"argmax": "arg\\,max", "argmin": "arg\\,min"}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '3-MatrixProductStates/TimeEvolution';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />

<!-- Normal Meta Tags -->
<meta name="author" context="QuantumGhent" />
<meta name="keywords" content="Julia, Tensor Networks, Quantum Many-Body Physics, Statistical Mechanics" />
<meta name="description" content=This website presents a set of lectures on Tensor Network methods />

<!-- Twitter tags -->
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@" />
<meta name="twitter:title" content="Time Evolution"/>
<meta name="twitter:description" content="This website presents a set of lectures on Tensor Network methods">
<meta name="twitter:creator" content="@">
<meta name="twitter:image" content="">

<!-- Opengraph tags -->
<meta property="og:title" content="Time Evolution" />
<meta property="og:type" content="website" />
<meta property="og:url" content="None" />
<meta property="og:image" content="" />
<meta property="og:description" content="This website presents a set of lectures on Tensor Network methods" />
<meta property="og:site_name" content="TensorTutorials" />
<meta name="theme-color" content="#ffffff" />

  </head>
<body>


    <span id="top"></span>

    <div class="qe-wrapper">

        <div class="qe-main">

            <div class="qe-page" id=3-MatrixProductStates/TimeEvolution>

                <div class="qe-page__toc">

                    <div class="inner">

                        
                        <div class="qe-page__toc-header">
                            On this page
                        </div>


                        <nav id="bd-toc-nav" class="qe-page__toc-nav">
                            <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tdvp">TDVP</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#time-evolution-mpo">Time Evolution MPO</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imaginary-time-evolution">Imaginary time evolution</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#finite-temperature">Finite Temperature</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#out-of-the-box-code">Out-of-the-box code</a></li>
</ul>
                            <p class="logo">
                                
                                    
                                    <a href=https://quantumghent.github.io/><img src="../_static/logo.png" class="logo" alt="logo"></a>
                                    
                                
                            </p>

                            <p class="powered">Powered by <a href="https://jupyterbook.org/">Jupyter Book</a></p>

                        </nav>

                        <div class="qe-page__toc-footer">
                            
                            
                            <p><a href="#top"><strong>Back to top</strong></a></p>
                        </div>

                    </div>

                </div>

                <div class="qe-page__header">

                    <div class="qe-page__header-copy">

                        <p class="qe-page__header-heading"><a href="../intro.html">TensorTutorials</a></p>

                        <p class="qe-page__header-subheading">Time Evolution</p>

                    </div>

                    <p class="qe-page__header-authors">QuantumGhent</p>

                </div> <!-- .page__header -->



                
                <main class="qe-page__content" role="main">
                    
                    <div>
                        
  <div class="tex2jax_ignore mathjax_ignore section" id="time-evolution">
<h1>Time Evolution<a class="headerlink" href="#time-evolution" title="Permalink to this heading">#</a></h1>
<p>In the case of quantum many body systems time evolution amounts to solving the time dependent schrodinger equation
$<span class="math notranslate nohighlight">\(i \frac{\partial}{\partial t} \ket{\Psi(t)}= \hat{H}\ket{\Psi(t)}\)</span><span class="math notranslate nohighlight">\(
for a given Hamiltonian \)</span>\hat{H}<span class="math notranslate nohighlight">\( with initial condition \)</span>\ket{\Psi_0}=\ket{\Psi(t_0)}<span class="math notranslate nohighlight">\(. For a time independent Hamiltonian the solution is given by \)</span>\ket{\Psi(t)} = \exp(-it\hat{H})\ket{\Psi_0}$. By approximating the time evolution operator in the Tensor Network language, we can also study real-time dynamics.</p>
<p>One should keep in mind that time evolution in general will increase the entanglement of the state so that in practice time evolution can only be done with Tensor Networks for relatively modest times. In case of a quench the entanglement will grow linearly so that the bond dimension of the MPS would need to grow exponentially in order to accurately follow the time evolved state.</p>
<p>Below are some time evolution methods for MPS</p>
<ul class="simple">
<li><p>(i)TEBD</p></li>
<li><p>TDVP</p></li>
<li><p>Time Evolution MPO</p></li>
</ul>
<p>In this part of the tutorial we will focus on the latter two.</p>
<div class="section" id="tdvp">
<h2>TDVP<a class="headerlink" href="#tdvp" title="Permalink to this heading">#</a></h2>
<p>The Time-Dependent Variational Principle is an old idea, originaly developed by Dirac and Frenkel in the 1930’s. The idea is to solve the schrodinger equation by minimizing
$<span class="math notranslate nohighlight">\(\|i \frac{\partial}{\partial t} \ket{\Psi(t)}- \hat{H}\ket{\Psi(t)}\|^2\)</span><span class="math notranslate nohighlight">\(
In the case of MPS, we can parametrize the state \)</span>\ket{\Psi(t)}<span class="math notranslate nohighlight">\( by a set of time dependent matrices \)</span>{A_1(t),A_2(t),\dots A_N(t)}<span class="math notranslate nohighlight">\( (where N is the system size for finiteMPS or the size of the unit cell for infinite MPS). In other words the state \)</span>\ket{\Psi(t)}<span class="math notranslate nohighlight">\( lives in a manifold determined by these matrices, the MPS-manifold. Geometrically the solution of the minimization problem is given by the projecting of the RHS of the schrodinger equation onto the MPS manifold 
\)</span><span class="math notranslate nohighlight">\(\frac{d}{dt} \ket{\Psi(A)} = -i \hat{P}_{T\ket{\Psi(A)}} \hat{H}\ket{\Psi(A)}\)</span><span class="math notranslate nohighlight">\(
where \)</span>\hat{P}_{T\ket{\Psi(A)}}<span class="math notranslate nohighlight">\( is the operator that projects the state onto the tangent space. As a consequence the time-evolving state will never leave the MPS manifold and parametrization in terms of \)</span>A(t)<span class="math notranslate nohighlight">\( makes sense. One can in principle work out the above equation on the level of the \)</span>A$ matrices and try to solve the above equation. This gives a complicated set of (non-linear) equations that can be solved by one’s favourite finite difference scheme, but requires the inversion of matrices with small singular values (and thus numerical instabilities). Instead, it turns out that a natural and inversion free way of solving this equation is possible if we gauge the mps to mixed form.</p>
<p>For a finite MPS, one can show that in the mixed gauge the projection operator is given by
<img alt="" src="../_images/TDVPProjector.png" />
The projection operation consists of two sums, one acting on the <span class="math notranslate nohighlight">\(AC\)</span> on site <span class="math notranslate nohighlight">\(n\)</span> and the other on the bond tensor <span class="math notranslate nohighlight">\(C\)</span> to the right of it</p>
<p>where we have brought the tensor on site <span class="math notranslate nohighlight">\(n\)</span> into AC form and one where we only have the . The insight is that we can solve each term seperately (and in fact in any order). For each site <span class="math notranslate nohighlight">\(n\)</span> of the MPS we have
$<span class="math notranslate nohighlight">\(\dot{A}_C(n) = -i \hat{H}_{eff}^{A_C}[ A_C(n)]\)</span><span class="math notranslate nohighlight">\( 
and \)</span><span class="math notranslate nohighlight">\(\dot{C}(n) = i \hat{H}_{eff}^{C}[ C(n)]\)</span><span class="math notranslate nohighlight">\(
Aproximating the effective Hamiltonians as independent of the other \)</span>A_C<span class="math notranslate nohighlight">\( and \)</span>C<span class="math notranslate nohighlight">\( these can be integrated exactly
\)</span><span class="math notranslate nohighlight">\(A_C(n,t+dt) = \exp(-idt \hat{H}_{\text{eff}}^{A_C}) A_C(n,t) \)</span><span class="math notranslate nohighlight">\( 
and \)</span><span class="math notranslate nohighlight">\(C(n,t+dt) = \exp(idt \hat{H}_{\text{eff}}^{C}) C(n,t) \)</span>$
A natural way to solve the set of equations is then, starting from the first site</p>
<ul class="simple">
<li><p>update <span class="math notranslate nohighlight">\(A_C(n)\)</span> according to the above formula</p></li>
<li><p>QR the resulting new <span class="math notranslate nohighlight">\(A_C'\)</span> to get a new updated <span class="math notranslate nohighlight">\(A_L(n,t+dt)\)</span> en <span class="math notranslate nohighlight">\(C(n,t+dt)\)</span></p></li>
<li><p>Update the new <span class="math notranslate nohighlight">\(C(n,t+dt)\)</span> via the above to get an <span class="math notranslate nohighlight">\(\tilde{C}\)</span></p></li>
<li><p>Absorb <span class="math notranslate nohighlight">\(\tilde{C}\)</span> into <span class="math notranslate nohighlight">\(A_R(n+1,t)\)</span> to get a new <span class="math notranslate nohighlight">\(A_C(n+1,t)\)</span> and repeat</p></li>
</ul>
<p>At the end of the chain one only updates the <span class="math notranslate nohighlight">\(A_C\)</span> since there is no <span class="math notranslate nohighlight">\(C\)</span> there. Doing the above left to right sweep gives a first order integrator i.e. we have solved the time evolution up to order <span class="math notranslate nohighlight">\(\mathcal{O}(dt^2)\)</span>. Since the terms can be solved in any order we can also perform a reverse sweep i.e. working from right to left. Combining this with the left to right sweep yields a second order integrator (because the reverse sweep is the adjoint of the forwards sweep).</p>
<p>For an infinite MPS one can also do a sweep-like update until some criteria converges to obtain new tensors <span class="math notranslate nohighlight">\(\{A_L,C,A_C,A_R\}\)</span>. However this can be costly since one has to iterate until convergence. Another option is to exploit the translational invariance of the system by demanding that <span class="math notranslate nohighlight">\(C=\tilde{C}=\exp(idt \hat{H}_{\text{eff}}^{C}) C(n,t+dt)\)</span>. This allows us to turn things around and find <span class="math notranslate nohighlight">\(C(n,t+dt)=\exp(-idt \hat{H}_{\text{eff}}^{C}) C(n)\)</span>. Given the newly found <span class="math notranslate nohighlight">\(C(n,t+dt)\)</span> and <span class="math notranslate nohighlight">\(A_C(n,t+dt)\)</span> one can find a new <span class="math notranslate nohighlight">\(A_L\)</span>, giving a MPS for t+dt.</p>
<p>The TDVP method has a couple of nice properties reminiscent of the Schrodinger equation it is trying to solve. First of all, it acts trivial on (numerical) eigenstates of <span class="math notranslate nohighlight">\(\hat{H}\)</span> since then <span class="math notranslate nohighlight">\(\hat{H}_{\text{eff}}^{A_C}[A_C] \propto A_C\)</span> and the whole MPS picks up a phase equal to <span class="math notranslate nohighlight">\(e^{-i dtE}\)</span>. In addition it conserves energy and is time-reversible for time-independent Hamiltonians.</p>
</div>
<div class="section" id="time-evolution-mpo">
<h2>Time Evolution MPO<a class="headerlink" href="#time-evolution-mpo" title="Permalink to this heading">#</a></h2>
<p>Perhaps the most natural way to perform the time evolution would be to write the time evolution operator as a MPO. The evolved state would then simply be the contraction of this MPO onto an MPS. The exponential can be approximated up to any order by its trunctated Taylor series
$<span class="math notranslate nohighlight">\(\exp(-\tau\hat{H}) = \hat{1} + \tau\hat{H} + \frac{\tau^2}{2}\hat{H}^2 + \mathcal{O}(\tau^3)\)</span><span class="math notranslate nohighlight">\(
The MPO approximation of the time evolution operator then boils down to implementing powers of \)</span>\hat{H}$ in an efficient (i.e. with the lowest possible MPO bond dimension) and size-extensive way. For example, for a MPO Hamiltonian of the form
<img alt="" src="../_images/MPOHam.png" /></p>
<p>which corresponds to the Hamiltonian
$<span class="math notranslate nohighlight">\(\hat{H} = \sum_i \hat{D}_i + \hat{C}_i \hat{B}_{i+1}\)</span><span class="math notranslate nohighlight">\(
The first order appriximation of \)</span>\exp(-\tau\hat{H})$ is given in table form by</p>
<p><img alt="" src="../_images/FirstOrderMPO.png" /></p>
<p>Doing the matrix multiplcation (and remembering that for MPO the boundary conditions are so the we need the left upper expression) we find
$<span class="math notranslate nohighlight">\(\exp(-\tau\hat{H}) \approx \hat{1} + \tau \left(\sum_i D_i + C_i B_{i+1}\right) = \hat{1} + \tau \hat{H}\)</span>$
as desired.</p>
<p>The trick for generating the first order approximation involves removing the third “level” from the MPO form of H and multiplying with the appropriate factor of τ. This can be visualised as follows</p>
<p><img alt="" src="../_images/FirstOrderTrick.png" /></p>
<p>This method can be extended to any desired order in <span class="math notranslate nohighlight">\(\tau\)</span> thus allowing us to represent <span class="math notranslate nohighlight">\(\exp(-\tau\hat{H})\)</span> as an MPO.</p>
</div>
<div class="section" id="imaginary-time-evolution">
<h2>Imaginary time evolution<a class="headerlink" href="#imaginary-time-evolution" title="Permalink to this heading">#</a></h2>
<p>Besides simulating dynamics, any time evolution method can also be used to find the groundstate of <span class="math notranslate nohighlight">\(\hat{H}\)</span> by taking <span class="math notranslate nohighlight">\(t\)</span> to be imaginary. The basis for this idea is the fact that
$<span class="math notranslate nohighlight">\(\ket{\Psi_0} = \lim_{\tau-&gt;+\infty} \frac{e^{-\tau \hat{H}} \ket{\Psi}}{\sqrt{\braket{\Psi|e^{-2\tau \hat{H}} |\Psi}}}\)</span><span class="math notranslate nohighlight">\(
where \)</span>\ket{\Psi}<span class="math notranslate nohighlight">\( is any initial state not orthogonal to the ground state. Indeed expanding the initial state in the eigenbasis of \)</span>\hat{H}<span class="math notranslate nohighlight">\( we have \)</span>\ket{\Psi} = \sum_i c_i \ket{E_i}<span class="math notranslate nohighlight">\( with \)</span>\ket{E_i}<span class="math notranslate nohighlight">\( the eigenstate with energy \)</span>E_i<span class="math notranslate nohighlight">\( and \)</span>E_0 &lt; E_1 &lt; E_2 &lt; \dots<span class="math notranslate nohighlight">\(. Then
\)</span><span class="math notranslate nohighlight">\(e^{-\tau \hat{H}} \ket{\Psi} = \sum_i c_i e^{-\tau E_i} \ket{E_i}\)</span>$</p>
<p>In taking the limit <span class="math notranslate nohighlight">\(\tau\to+\infty\)</span> the slowest vanishing exponential is that of <span class="math notranslate nohighlight">\(E_0\)</span>. In this way the ground state gets projected out of the initial state. Demanding that the state is normalized gives
$<span class="math notranslate nohighlight">\(\lim_{\tau-&gt;+\infty} \frac{e^{-\tau \hat{H}} \ket{\Psi}}{\sqrt{\braket{\Psi|e^{-2\tau \hat{H}} |\Psi}}} = \lim_{\tau-&gt;+\infty} \frac{\sum_i c_i e^{-\tau E_i} \ket{E_i}}{\sqrt{\sum_i |c_i|^2 e^{-2\tau E_i}}} = \frac{c_0 }{|c_0|} \ket{E_0}\)</span>$
which gives the ground state up to an irrelevant phase factor.</p>
</div>
<div class="section" id="finite-temperature">
<h2>Finite Temperature<a class="headerlink" href="#finite-temperature" title="Permalink to this heading">#</a></h2>
<p>It is possible to use time evolution methods to construct thermal density operators i.e. <span class="math notranslate nohighlight">\(\rho = \frac{1}{Z}e^{-\beta \hat{H}}\)</span> with <span class="math notranslate nohighlight">\(\beta=1/T\)</span> and <span class="math notranslate nohighlight">\(Z\)</span> a normalization constant. The idea here is to write <span class="math notranslate nohighlight">\(\rho\)</span> as an MPO
<img alt="" src="../_images/DensityMatrix.png" />
with the constraint that
<img alt="" src="../_images/Mconstraint.png" />
This particula form ensures that <span class="math notranslate nohighlight">\(\rho\)</span> is a positive semi-definite and thus physical. Note that for <span class="math notranslate nohighlight">\(d_k=1\)</span> we obtain the density matrix of a pure state. We can represent <span class="math notranslate nohighlight">\(\rho\)</span> as the desnity matrix of pure state (i.e. a MPS) by introducing ancilla’s (i.e. ) <span class="math notranslate nohighlight">\(\{\ket{a_k}\}\)</span> so that
<img alt="" src="../_images/AncillaMPS.png" />
One immedeatly sees that <span class="math notranslate nohighlight">\(\rho=\text{Tr}_a({\ket{\Psi}\bra{\Psi}})\)</span>. The thermal density operators <span class="math notranslate nohighlight">\(\rho(\beta)\)</span> for any <span class="math notranslate nohighlight">\(\beta\)</span> can then be found by starting from the <span class="math notranslate nohighlight">\(\beta=0\)</span> state <span class="math notranslate nohighlight">\(\rho(0)=\mathbf{1}\)</span> and performing imaginary time evolution
$<span class="math notranslate nohighlight">\(e^{-\beta H} = (e^{-\Delta \tau \hat{H}})^M\rho(0)(e^{-\Delta \tau \hat{H}})^M\)</span><span class="math notranslate nohighlight">\(
 with \)</span>\Delta \tau = \frac{\beta}{2M}<span class="math notranslate nohighlight">\(. Or in terms of the purification state \)</span>\ket{\Psi(\beta)}=(e^{-\Delta \tau \hat{H}})^M \ket{\Psi(0)}$.</p>
</div>
<div class="section" id="out-of-the-box-code">
<h2>Out-of-the-box code<a class="headerlink" href="#out-of-the-box-code" title="Permalink to this heading">#</a></h2>
<p>Below is some code on how MPSKit and MPSKitModels can be used out-of-the-box to perform time evolution.</p>
<p><code class="docutils literal notranslate"><span class="pre">H₀</span> <span class="pre">=</span> <span class="pre">transverse_field_ising(;J=1.0,g=0.0)</span></code></p>
<p>#Create a MPS with physical bond dimension d=2 and virtual D=50 and optimize it</p>
<p><code class="docutils literal notranslate"><span class="pre">gs</span> <span class="pre">=</span> <span class="pre">InfiniteMPS([2],[50]);</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">(gs,envs,_)</span> <span class="pre">=</span> <span class="pre">find_groundstate(gs,H₀,VUMPS(maxiter=400));</span></code></p>
<p>#Let’s check some expectation values</p>
<p><code class="docutils literal notranslate"><span class="pre">sx_gs</span> <span class="pre">=</span> <span class="pre">sum(expectation_value(gs,σₓ))/length(gs)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">E_gs</span> <span class="pre">=</span> <span class="pre">sum(expectation_value(gs,H₀,envs))/length(gs)</span></code></p>
<p>#Let’s define the algorithm for time evolution and the Hamiltonian for it</p>
<p><code class="docutils literal notranslate"><span class="pre">alg</span> <span class="pre">=</span> <span class="pre">TDVP()</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">Ht</span> <span class="pre">=</span> <span class="pre">transverse_field_ising(;J=1.0,g=0.0)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">dt</span> <span class="pre">=</span> <span class="pre">0.01</span></code></p>
<p>Do the quench</p>
<p><code class="docutils literal notranslate"><span class="pre">(st_t,envs)</span> <span class="pre">=</span> <span class="pre">timestep(gs,Ht,dt,alg)</span></code></p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./3-MatrixProductStates"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                    </div>
                    
                </main> <!-- .page__content -->
                


                <footer class="qe-page__footer">

                    <p><a href="https://creativecommons.org/licenses/by-sa/4.0/"><img src="https://licensebuttons.net/l/by-sa/4.0/80x15.png"></a></p>

                    <p>Creative Commons License &ndash; This work is licensed under a Creative Commons Attribution-ShareAlike 4.0 International.</p>

                </footer> <!-- .page__footer -->

            </div> <!-- .page -->

            

            
            <div class="qe-sidebar bd-sidebar inactive" id="site-navigation">

                <div class="qe-sidebar__header">


                    Contents

                </div>

                <nav class="qe-sidebar__nav" id="qe-sidebar-nav" aria-label="Main navigation">
                    <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Introduction
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../1-Introduction/QuantumManyBody.html">
   1. Quantum Many-Body Theory
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../1-Introduction/TensorNetworks.html">
   2. Tensor Network Theory
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../1-Introduction/Julia.html">
   3. Getting started with Julia
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Tensors
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../2-Tensors/TensorKit.html">
   4. TensorKit.jl
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../2-Tensors/TensorOperations.html">
   5. TensorOperations.jl
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Matrix Product States
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="MatrixProductStates.html">
   6. Matrix Product States
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="MatrixProductOperators.html">
   7. Matrix Product Operators
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="InfiniteMPS.html">
   8. Infinite Matrix Product States
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Algorithms.html">
   9. Algorithms
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Applications.html">
   10. Applications
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Other
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../References.html">
   11. References
  </a>
 </li>
</ul>

                </nav>

                <div class="qe-sidebar__footer">

                </div>

            </div> <!-- .sidebar -->
            
        </div> <!-- .main -->

        <div class="qe-toolbar">

            <div class="qe-toolbar__inner">

                <ul class="qe-toolbar__main">
                    <li data-tippy-content="Table of Contents" class="btn__sidebar"><i data-feather="menu"></i></li>
                    <li data-tippy-content="Home"><a href="../intro.html"><i data-feather="home"></i></a></li>
                    <li><a href="https://quantumghent.github.io/" title="">QuantumGroup@UGent</a></li>
                    <li><a href="https://github.com/quantumghent" title="GitHub" rel="external nofollow noopener" target="_blank"><i class="fab fa-github"></i></a></li>
                </ul>

                <ul class="qe-toolbar__links">
                    <li class="btn__search">
                        <form action="../search.html" method="get">
                            <input type="search" class="form-control" name="q" id="search-input" placeholder="Search..." aria-label="Search..." autocomplete="off" accesskey="k">
                            <i data-feather="search" id="search-icon"></i>
                        </form>
                    </li>
                    <li data-tippy-content="Fullscreen" class="btn__fullscreen"><i data-feather="maximize"></i></li>
                    <li data-tippy-content="Increase font size" class="btn__plus"><i data-feather="plus-circle"></i></li>
                    <li data-tippy-content="Decrease font size" class="btn__minus"><i data-feather="minus-circle"></i></li>
                    <li data-tippy-content="Change contrast" class="btn__contrast"><i data-feather="sunset"></i></li>
                    <li class="settings-button" id="settingsButton"><div data-tippy-content="Launch Notebook"><i data-feather="play-circle"></i></div></li>
                        <li data-tippy-content="Download PDF" onClick="window.print()"><i data-feather="file"></i></li>
                    <li data-tippy-content="View Source"><a target="_blank" href="https://github.com/quantumghent/TensorTutorials/blob/main/lectures/3-MatrixProductStates/TimeEvolution.md" download><i data-feather="github"></i></a></li>
                </ul>

            </div>

        </div> <!-- .toolbar -->
        <div id="downloadPDFModal" style="display: none;">
            <ul class="pdf-options" style="display: block;">
                <li class="download-pdf-book" onClick="window.print()">
                    <p>Lecture (PDF)</p>
                </li>
                <li class="download-pdf-file">
                    <a href="" download><p>Book (PDF)</p></a>
                </li>
            </ul>
        </div>
        <div id="settingsModal" style="display: none;">
            <p class="modal-title"> Notebook Launcher </p>
            <div class="modal-desc">
            <p>
                Choose public or private cloud service for "Launch" button.
            </p>
            </div>
            <p class="modal-subtitle">Select a server</p>
            <ul class="modal-servers">
            <li class="active launcher-public">
                <span class="label">Public</span>
                <select id="launcher-public-input">
                
                    <option value="https://colab.research.google.com/github/quantumghent/TensorTutorials/blob/main/3-MatrixProductStates/TimeEvolution.ipynb">Colab</option>
                
                </select>
                <i class="fas fa-check-circle"></i>
            </li>
            <li class="launcher-private">
                <span class="label">Private</span>
                <input type="text" id="launcher-private-input" data-repourl="https://github.com/quantumghent/TensorTutorials" data-urlpath="tree/TensorTutorials/3-MatrixProductStates/TimeEvolution.ipynb" data-branch=main>
                <i class="fas fa-check-circle"></i>
            </li>
            </ul>
            <p class="launch"><a href="https://colab.research.google.com/github/quantumghent/TensorTutorials/blob/main/3-MatrixProductStates/TimeEvolution.ipynb" id="advancedLaunchButton" target="_blank">Launch Notebook</a></p>
            <script>
                // QuantEcon Notebook Launcher
                const launcherTypeElements = document.querySelectorAll('#settingsModal .modal-servers li');
                // Highlight the server type if previous selection exists
                if (typeof localStorage.launcherType !== 'undefined') {
                  for (var i = 0; i < launcherTypeElements.length; i++) {
                    launcherTypeElements[i].classList.remove('active');
                    if ( launcherTypeElements[i].classList.contains(localStorage.launcherType) ) {
                      launcherTypeElements[i].classList.add('active');
                    }
                  }
                }
                // Highlight server type on click and set local storage value
                for (var i = 0; i < launcherTypeElements.length; i++) {
                  launcherTypeElements[i].addEventListener('click', function() {
                    for (var j = 0; j < launcherTypeElements.length; j++) {
                      launcherTypeElements[j].classList.remove('active');
                    }
                    this.classList.add('active');
                    if ( this.classList.contains('launcher-private') ) {
                      localStorage.launcherType = 'launcher-private';
                    } else if ( this.classList.contains('launcher-public') ) {
                      localStorage.launcherType = 'launcher-public';
                    }
                    setLaunchServer();
                  })
                }
                const launcherPublic = document.getElementById('launcher-public-input');
                const launcherPrivate = document.getElementById('launcher-private-input');
                const pageName = "3-MatrixProductStates/TimeEvolution";
                const repoURL = "https://github.com/quantumghent/TensorTutorials";
                const urlPath = "tree/TensorTutorials/3-MatrixProductStates/TimeEvolution.ipynb";
                const branch = "main"
                const launchNotebookLink = document.getElementById('advancedLaunchButton');

                // Highlight public server option if previous selection exists
                if (typeof localStorage.launcherPublic !== 'undefined') {
                  launcherPublic.value = localStorage.launcherPublic;
                }
                // Update local storage upon public server selection
                launcherPublic.addEventListener('change', (event) => {
                  setLaunchServer();
                });
                // Populate private server input if previous entry exists
                if (typeof localStorage.launcherPrivate !== 'undefined') {
                  launcherPrivate.value = localStorage.launcherPrivate;
                }
                // Update local storage when a private server is entered
                launcherPrivate.addEventListener('input', (event) => {
                  setLaunchServer();
                });

                // Function to update the "Launch Notebook" link href
                function setLaunchServer() {
                  launchNotebookLink.removeAttribute("style")
                  if ( localStorage.launcherType == 'launcher-private' ) {
                    let repoPrefix = "/jupyter/hub/user-redirect/git-pull?repo=" + repoURL + "&branch=" + branch + "&urlpath=" + urlPath;
                    launcherPrivateValue = launcherPrivate.value
                    if (!launcherPrivateValue) {
                        launchNotebookLink.removeAttribute("href")
                        launchNotebookLink.style.background = "grey"
                        return
                    }
                    localStorage.launcherPrivate = launcherPrivateValue;
                    privateServer = localStorage.launcherPrivate.replace(/\/$/, "")
                    if (!privateServer.includes("http")) {
                        privateServer = "http://" + privateServer
                    }
                    launchNotebookLinkURL = privateServer + repoPrefix;
                  } else if ( localStorage.launcherType == 'launcher-public' ) {
                    launcherPublicValue = launcherPublic.options[launcherPublic.selectedIndex].value;
                    localStorage.launcherPublic = launcherPublicValue;
                    launchNotebookLinkURL = localStorage.launcherPublic;
                  }
                  if (launchNotebookLinkURL) launchNotebookLink.href = launchNotebookLinkURL;
                }
                // Check if user has previously selected a server
                if ( (typeof localStorage.launcherPrivate !== 'undefined') || (typeof localStorage.launcherPublic !== 'undefined') ) {
                  setLaunchServer();
                }
                </script>

        </div>

    </div> <!-- .wrapper-->
  </body>
</html>